var cov_1kwhp9qi4q=function(){var path='/Users/codifycodify/Documents/GitHub/challenge-git/lib/authify.js',hash='00a3eb6da2a9813c0c13d2b2aa2b747689997b22',Function=function(){}.constructor,global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/Users/codifycodify/Documents/GitHub/challenge-git/lib/authify.js',statementMap:{'0':{start:{line:1,column:12},end:{line:1,column:28}},'1':{start:{line:2,column:16},end:{line:2,column:44}},'2':{start:{line:4,column:13},end:{line:4,column:33}},'3':{start:{line:6,column:16},end:{line:8,column:48}},'4':{start:{line:10,column:0},end:{line:28,column:1}},'5':{start:{line:11,column:2},end:{line:27,column:3}},'6':{start:{line:12,column:4},end:{line:26,column:6}},'7':{start:{line:13,column:6},end:{line:13,column:29}},'8':{start:{line:13,column:15},end:{line:13,column:29}},'9':{start:{line:14,column:6},end:{line:16,column:7}},'10':{start:{line:15,column:8},end:{line:15,column:57}},'11':{start:{line:18,column:6},end:{line:18,column:22}},'12':{start:{line:19,column:23},end:{line:19,column:28}},'13':{start:{line:20,column:6},end:{line:20,column:60}},'14':{start:{line:20,column:43},end:{line:20,column:60}},'15':{start:{line:21,column:6},end:{line:21,column:67}},'16':{start:{line:21,column:50},end:{line:21,column:67}},'17':{start:{line:23,column:6},end:{line:23,column:73}},'18':{start:{line:23,column:22},end:{line:23,column:73}},'19':{start:{line:25,column:6},end:{line:25,column:57}},'20':{start:{line:31,column:2},end:{line:31,column:49}},'21':{start:{line:35,column:12},end:{line:35,column:44}},'22':{start:{line:36,column:2},end:{line:36,column:22}},'23':{start:{line:37,column:2},end:{line:37,column:12}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:10,column:17},end:{line:10,column:18}},loc:{start:{line:10,column:31},end:{line:28,column:1}},line:10},'1':{name:'authify',decl:{start:{line:11,column:18},end:{line:11,column:25}},loc:{start:{line:11,column:47},end:{line:27,column:3}},line:11},'2':{name:'(anonymous_2)',decl:{start:{line:12,column:24},end:{line:12,column:25}},loc:{start:{line:12,column:46},end:{line:26,column:5}},line:12},'3':{name:'testAuthentic',decl:{start:{line:30,column:9},end:{line:30,column:22}},loc:{start:{line:30,column:38},end:{line:32,column:1}},line:30},'4':{name:'createAuthError',decl:{start:{line:34,column:9},end:{line:34,column:24}},loc:{start:{line:34,column:31},end:{line:38,column:1}},line:34}},branchMap:{'0':{loc:{start:{line:6,column:16},end:{line:8,column:48}},type:'cond-expr',locations:[{start:{line:7,column:4},end:{line:7,column:17}},{start:{line:8,column:4},end:{line:8,column:48}}],line:6},'1':{loc:{start:{line:13,column:6},end:{line:13,column:29}},type:'if',locations:[{start:{line:13,column:6},end:{line:13,column:29}},{start:{line:13,column:6},end:{line:13,column:29}}],line:13},'2':{loc:{start:{line:14,column:6},end:{line:16,column:7}},type:'if',locations:[{start:{line:14,column:6},end:{line:16,column:7}},{start:{line:14,column:6},end:{line:16,column:7}}],line:14},'3':{loc:{start:{line:14,column:10},end:{line:14,column:32}},type:'binary-expr',locations:[{start:{line:14,column:10},end:{line:14,column:16}},{start:{line:14,column:20},end:{line:14,column:32}}],line:14},'4':{loc:{start:{line:20,column:6},end:{line:20,column:60}},type:'if',locations:[{start:{line:20,column:6},end:{line:20,column:60}},{start:{line:20,column:6},end:{line:20,column:60}}],line:20},'5':{loc:{start:{line:21,column:6},end:{line:21,column:67}},type:'if',locations:[{start:{line:21,column:6},end:{line:21,column:67}},{start:{line:21,column:6},end:{line:21,column:67}}],line:21},'6':{loc:{start:{line:23,column:6},end:{line:23,column:73}},type:'if',locations:[{start:{line:23,column:6},end:{line:23,column:73}},{start:{line:23,column:6},end:{line:23,column:73}}],line:23},'7':{loc:{start:{line:35,column:22},end:{line:35,column:43}},type:'binary-expr',locations:[{start:{line:35,column:22},end:{line:35,column:25}},{start:{line:35,column:29},end:{line:35,column:43}}],line:35}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0],'5':[0,0],'6':[0,0],'7':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var xtend=(cov_1kwhp9qi4q.s[0]++,require('xtend'));var Authentic=(cov_1kwhp9qi4q.s[1]++,require('authentic-service'));var config=(cov_1kwhp9qi4q.s[2]++,require('../config'));var authentic=(cov_1kwhp9qi4q.s[3]++,process.env.NODE_ENV==='test'?(cov_1kwhp9qi4q.b[0][0]++,testAuthentic):(cov_1kwhp9qi4q.b[0][1]++,Authentic({server:config.authentic.host})));cov_1kwhp9qi4q.s[4]++;module.exports=function(fn){cov_1kwhp9qi4q.f[0]++;cov_1kwhp9qi4q.s[5]++;return function authify(req,res,opts,cb){cov_1kwhp9qi4q.f[1]++;cov_1kwhp9qi4q.s[6]++;authentic(req,res,function(err,creds){cov_1kwhp9qi4q.f[2]++;cov_1kwhp9qi4q.s[7]++;if(err){cov_1kwhp9qi4q.b[1][0]++;cov_1kwhp9qi4q.s[8]++;return cb(err);}else{cov_1kwhp9qi4q.b[1][1]++;}cov_1kwhp9qi4q.s[9]++;if((cov_1kwhp9qi4q.b[3][0]++,!creds)||(cov_1kwhp9qi4q.b[3][1]++,!creds.email)){cov_1kwhp9qi4q.b[2][0]++;cov_1kwhp9qi4q.s[10]++;return cb(createAuthError('Invalid Credentials'));}else{cov_1kwhp9qi4q.b[2][1]++;}cov_1kwhp9qi4q.s[11]++;req.auth=creds;var authorized=(cov_1kwhp9qi4q.s[12]++,false);cov_1kwhp9qi4q.s[13]++;if(creds.email.match(/@lincx.la$/)){cov_1kwhp9qi4q.b[4][0]++;cov_1kwhp9qi4q.s[14]++;authorized=true;}else{cov_1kwhp9qi4q.b[4][1]++;}cov_1kwhp9qi4q.s[15]++;if(creds.email.match(/@interlincx\.com$/)){cov_1kwhp9qi4q.b[5][0]++;cov_1kwhp9qi4q.s[16]++;authorized=true;}else{cov_1kwhp9qi4q.b[5][1]++;}cov_1kwhp9qi4q.s[17]++;if(authorized){cov_1kwhp9qi4q.b[6][0]++;cov_1kwhp9qi4q.s[18]++;return fn(req,res,xtend(opts,{auth:creds}),cb);}else{cov_1kwhp9qi4q.b[6][1]++;}cov_1kwhp9qi4q.s[19]++;cb(createAuthError('Unauthorized: '+creds.email));});};};function testAuthentic(req,res,cb){cov_1kwhp9qi4q.f[3]++;cov_1kwhp9qi4q.s[20]++;return cb(null,{email:'test@interlincx.com'});}function createAuthError(msg){cov_1kwhp9qi4q.f[4]++;var err=(cov_1kwhp9qi4q.s[21]++,new Error((cov_1kwhp9qi4q.b[7][0]++,msg)||(cov_1kwhp9qi4q.b[7][1]++,'Unauthorized')));cov_1kwhp9qi4q.s[22]++;err.statusCode=401;cov_1kwhp9qi4q.s[23]++;return err;}